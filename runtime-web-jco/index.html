<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>Wit runtime JCO</title>
    <base href="." />
  </head>
  <body>
    <script type="module">
      import("./out-dir/guest_exports.js").then(async (module) => {
        let instantiate = () =>
          module.instantiate(
            async (url, imports) => {
              let data = await fetch("out-dir/" + url);
              return WebAssembly.compile(await data.arrayBuffer(), imports);
            },
            {
              ["import-empty"]: {
                default: (value) => {
                  return value;
                },
              },
              ["import-empty-list"]: {
                default: (list) => {
                  return list.map((val) => {
                    switch (val) {
                      case "a000":
                        return "a001";
                      case "a001":
                        return "a000";
                      case "a255":
                        return "a256";
                      case "a256":
                        return "a255";
                      default:
                        return val;
                    }
                  });
                },
              },
            }
          );

        let instance1 = await instantiate();
        let list = ["a000", "a001", "a002", "a256", "a255", "a254"];
        console.log(list, instance1.exportEmptyList(list));
      });
    </script>
  </body>
</html>
