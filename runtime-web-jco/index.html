<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>Wit runtime JCO</title>
    <base href="." />
  </head>
  <body>
    <script type="module">
      import("./out-dir/better-component.js").then(async (module) => {
        let instantiate = () =>
          module.instantiate(
            // async (url, imports) => {
            //   let data = await fetch("out-dir/" + url);
            //   return WebAssembly.compile(await data.arrayBuffer(), imports);
            // },
            {
              print: { default: console.log },
              ["import-point"]: {
                default: (point) => {
                  point.x += 100;
                  return point;
                },
              },
            }
          );

        let instance1 = await instantiate();
        instance1.run();
        console.log(instance1.movePoint({ x: 50, y: 50 }));

        let instance2 = await instantiate();

        console.log("instance 1:", instance1.increment());
        console.log("instance 1:", instance1.increment());
        console.log("instance 2:", instance2.increment());
        console.log("instance 1:", instance1.increment());
        console.log("instance 2:", instance2.increment());
        console.log("instance 1:", instance1.increment());
      });
    </script>
  </body>
</html>
